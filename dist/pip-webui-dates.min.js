!function(e){"use strict";e.module("pipDateTimes",["pipDate","pipDateRange","pipTimeRangeEdit","pipTimeRange","pipDatesUtils","pipDateFormat","pipDateTimeFilters"]),e.module("pipDateTimesControls",["pipDateTimes"])}(window.angular),function(e){try{e=angular.module("pipDates.Templates")}catch(t){e=angular.module("pipDates.Templates",[])}e.run(["$templateCache",function(e){e.put("date/date.html",'<div class="pip-date layout-row flex" tabindex="-1"><md-input-container class="tm0 flex"><md-select class="pip-date-day tm0 flex" ng-disabled="disableControls" ng-model="day" placeholder="{{dayLabel}}" ng-change="onDayChanged()"><md-option ng-value="opt" ng-repeat="opt in days track by opt">{{:: opt }}</md-option></md-select></md-input-container><div class="w16 flex-fixed"></div><md-input-container class="tm0 flex"><md-select class="pip-date-month tm0 flex" ng-disabled="disableControls" ng-model="month" placeholder="{{monthLabel}}" ng-change="onMonthChanged()"><md-option ng-value="opt.id" ng-repeat="opt in months track by opt.id">{{:: opt.name }}</md-option></md-select></md-input-container><div class="w16 flex-fixed"></div><md-input-container class="tm0 flex"><md-select class="pip-date-year tm0 flex" ng-disabled="disableControls" ng-model="year" placeholder="{{yearLabel}}" ng-change="onYearChanged()"><md-option ng-value="opt" ng-repeat="opt in years track by opt">{{:: opt }}</md-option></md-select></md-input-container></div>')}])}(),function(e){try{e=angular.module("pipDates.Templates")}catch(t){e=angular.module("pipDates.Templates",[])}e.run(["$templateCache",function(e){e.put("date_range/date_range.html",'<div class="pip-date-range layout-row flex" tabindex="-1"><md-input-container ng-show="isDay()" class="tm0 pip-day flex" ng-class="{\'flex-fixed\' : $mdMedia(\'gt-xs\')}"><md-select class="select-day w-stretch" ng-class="{\'pip-no-line\' : pipNoLine}" ng-disable="{{disableControls}}" md-on-open="onDayClick()" ng-model="day" ng-change="onDayChanged()" placeholder="{{dayLabel}}" aria-label="DAY"><md-option ng-value="opt" ng-repeat="opt in days track by opt">{{nameDays[$index]}} {{ opt }}</md-option></md-select></md-input-container><md-input-container ng-show="isWeek()" class="tm0 flex" ng-class="{\'flex-fixed\' : $mdMedia(\'gt-xs\')}"><md-select class="select-week w-stretch" ng-class="{\'pip-no-line\' : pipNoLine}" ng-disable="{{disableControls}}" ng-model="week" ng-change="onWeekChange()" placeholder="{{weekLabel}}" aria-label="WEEK"><md-option ng-value="opt.id" ng-repeat="opt in weeks track by opt.id">{{ opt.name }}</md-option></md-select></md-input-container><div class="flex-fixed" ng-class="{\'w16\': $mdMedia(\'gt-xs\'), \'w8\': $mdMedia(\'xs\')}" ng-show="isDay() || isWeek()"></div><md-input-container ng-show="isMonth() && !monthFormatShort" class="tm0 flex min-w72" ng-class="{\'flex-fixed\' : $mdMedia(\'gt-xs\')}"><md-select class="select-month w-stretch" ng-class="{\'pip-no-line\' : pipNoLine}" ng-disable="{{disableControls}}" md-on-open="onMonthClick()" ng-model="month" ng-change="onMonthChanged()" placeholder="{{monthLabel}}" aria-label="MONTH"><md-option ng-value="opt.id" ng-repeat="opt in months track by opt.id">{{ opt.name }}</md-option></md-select></md-input-container><md-input-container ng-show="isMonth() && monthFormatShort" class="flex tm0" ng-class="{\'flex-fixed\' : $mdMedia(\'gt-xs\')}"><md-select class="select-month w-stretch" ng-class="{\'pip-no-line\' : pipNoLine}" ng-disable="{{disableControls}}" md-on-open="onMonthClick()" ng-model="month" ng-change="onMonthChanged()" placeholder="{{monthLabel}}" aria-label="MONTH"><md-option ng-value="opt.id" ng-repeat="opt in shortMonths track by opt.id">{{ opt.name }}</md-option></md-select></md-input-container><div class="flex-fixed" ng-class="{\'w16\': $mdMedia(\'gt-xs\'), \'w8\': $mdMedia(\'xs\')}" ng-show="isMonth()"></div><md-input-container class="tm0 flex" ng-class="{\'flex-fixed\' : $mdMedia(\'gt-xs\')}"><md-select class="select-year w-stretch" ng-class="{\'pip-no-line\' : pipNoLine}" ng-disable="{{disableControls}}" md-on-open="onYearClick()" ng-model="year" ng-change="onYearChanged()" placeholder="{{yearLabel}}" aria-label="YEAR"><md-option ng-value="opt" ng-repeat="opt in years track by opt">{{ opt }}</md-option></md-select></md-input-container></div>')}])}(),function(e){try{e=angular.module("pipDates.Templates")}catch(t){e=angular.module("pipDates.Templates",[])}e.run(["$templateCache",function(e){e.put("time_range_edit/time_range_edit.html",'<div class="event-edit layout-row layout-xs-column flex layout-align-start-start"><div flex="47" class="w-stretch rm24-flex0"><p class="text-caption text-grey tm0">{{startLabel}}</p><div class="layout-row layout-align-space-between-center"><div class="rm16 pip-datepicker-container" flex="49"><md-datepicker ng-model="data.startDate" xmd-placeholder="{{startLabel}}" ng-change="onChangeStartDate()" ng-disabled="isDisabled()" aria-label="START-DATE"></md-datepicker></div><div flex=""><md-input-container class="w-stretch tm0"><md-select aria-label="START-TIME" class="tm0 bm0" ng-model="data.startTime" ng-disabled="isDisabled()" ng-change="onChangeStartTime()"><md-option ng-value="opt.id" ng-repeat="opt in intervalTimeCollection track by opt.id">{{ opt.time }}</md-option></md-select></md-input-container></div></div></div><div flex="47" class="w-stretch"><p class="text-caption text-grey tm0">{{endLabel}}</p><div class="layout-row layout-align-space-between-center"><div class="rm16 pip-datepicker-container flex-49"><md-datepicker ng-model="data.endDate" xmd-placeholder="{{endLabel}}" ng-disabled="isDisabled()" ng-change="onChangeEndDate()" aria-label="END-DATE"></md-datepicker></div><div flex=""><md-input-container class="w-stretch tm0"><md-select aria-label="END-TIME" class="tm0 bm0" ng-model="data.endTime" ng-change="onChangeEndTime()" ng-disabled="isDisabled()"><md-option ng-value="opt.id" ng-repeat="opt in intervalTimeCollection track by opt.id">{{ opt.time }}</md-option></md-select></md-input-container></div></div></div></div>')}])}(),function(e){try{e=angular.module("pipDates.Templates")}catch(t){e=angular.module("pipDates.Templates",[])}e.run(["$templateCache",function(e){e.put("time_range/time_range.html",'<p><span ng-if="data.start != null">{{data.start | formatShortDateTime}}</span> <span class="rm4 lm4" ng-if="data.start && data.end">-</span> <span ng-if="data.end != null">{{data.end | formatShortDateTime}}</span></p>')}])}(),function(e,t){"use strict";var a=e.module("pipDate",["pipDates.Templates"]);a.directive("pipDate",function(){return{restrict:"EA",require:"ngModel",scope:{timeMode:"@pipTimeMode",disabled:"&ngDisabled",model:"=ngModel",ngChange:"&"},templateUrl:"date/date.html",controller:"pipDateController"}}),a.controller("pipDateController",["$scope","$element","pipTranslate",function(e,a,n){function r(e,t){var a,n=31,r=[];for(4===e||6===e||9===e||11===e?n=30:2===e&&(n=t&&t%4===0?29:28),a=1;a<=n;a++)r.push(a);return r}function i(){var e,t=[];for(e=1;e<=12;e++)t.push({id:e,name:n.translate("MONTH_"+e)});return t}function o(){var t,a=(new Date).getFullYear(),n="future"===e.timeMode?a:a-100,r="past"===e.timeMode?a:a+100,i=[];if("past"===e.timeMode)for(t=r;t>=n;t--)i.push(t);else for(t=n;t<=r;t++)i.push(t);return i}function l(){var t=r(e.month,e.year);e.days.length!==t.length&&(e.day>t.length&&(e.day=t.length),e.days=t)}function d(a){var n=a?t.isDate(a)?a:new Date(a):null,i=n?n.getDate():null,o=n?n.getMonth()+1:null,l=n?n.getFullYear():null;e.month!==o&&e.year!==l&&(e.days=r(e.month,e.year)),e.day=i,e.month=o,e.year=l}function u(){var t;e.day&&e.month&&e.year&&(t=new Date(e.year,e.month-1,e.day,0,0,0,0),e.model=t,e.ngChange())}var p;e.onDayChanged=function(){u()},e.onMonthChanged=function(){l(),u()},e.onYearChanged=function(){l(),u()},p=e.model?t.isDate(e.model)?e.model:new Date(e.model):null,e.day=p?p.getDate():null,e.month=p?p.getMonth()+1:null,e.year=p?p.getFullYear():null,e.dayLabel=n.translate("DAY"),e.monthLabel=n.translate("MONTH"),e.yearLabel=n.translate("YEAR"),e.days=r(e.month,e.year),e.months=i(),e.years=o(),e.disableControls=!!e.disabled&&e.disabled(),e.$watch("model",function(e){d(e)}),e.$watch(e.disabled,function(t){e.disableControls=t})}])}(window.angular,window._),function(e,t){"use strict";var a=e.module("pipDateRange",["pipDates.Templates"]);a.directive("pipDateRange",function(){return{restrict:"EA",require:"ngModel",scope:{timeMode:"@pipTimeMode",disabled:"&ngDisabled",model:"=ngModel",pipChanged:"&",pipDateRangeType:"@",pipDateFormat:"@",pipNoLine:"@"},templateUrl:"date_range/date_range.html",controller:"pipDateRangeController"}}),a.controller("pipDateRangeController",["$scope","$element","pipTranslate","$mdMedia","$rootScope",function(e,a,n,r,i){function o(){N.day=e.day,N.month=e.month,N.year=e.year,N.week=e.week,N.dateRangeType=e.pipDateRangeType,N.model=e.model}function l(){e.days=s(e.month,e.year),e.weeks=c(e.month,e.year),e.months=g(),e.shortMonths=g(!0),e.years=T()}function d(){(!w.model||w.model&&w.model.getTime()>=e.model.getTime())&&e.weeks&&e.weeks[e.week]&&e.weeks[e.week].id<=0&&(e.month<12?e.month+=1:(e.month=1,e.year+=1),l())}function u(){var t;t=e.model?new Date(e.model):null,e.day=t?t.getUTCDate():null,e.month=t?t.getUTCMonth()+1:null,e.year=t?t.getUTCFullYear():null,e.week=t?m(e.day,e.month-1,e.year):null,l(),"weekly"===e.pipDateRangeType?(d(),f()):M(),y()}function p(e,t){var a=31;return 4===e||6===e||9===e||11===e?a=30:2===e&&(a=t&&t%4===0?29:28),a}function s(t,a){var n,r,o,l;for(l=i.$language||"en",n=p(t,a),e.nameDays=[],r=[],o=1;o<=n;o++)r.push(o),e.nameDays.push(e.daysWeek[l][new Date(a,t-1,o).getDay()]);return r}function m(e,t,a){var n,r,i;return n=new Date(Date.UTC(a,t,e)),r=n.getUTCDay()?n.getUTCDay():7,i=1===r?e:e+1-r}function D(e,t,a){var n,r;return n=e+6>t?t-e-6:e+6,r=e>0?e:a+e,r.toString()+" - "+Math.abs(n).toString()}function c(e,t){var a,n,r,i;for(a=[],n=p(e,t),i=m(1,e-1,t),r=e-1?p(e-1,t):p(12,t-1);i<n+1;)a.push({id:i,name:D(i,n,r)}),i+=7;return a}function g(){var e,t;for(e=[],t=1;t<=12;t++)e.push({id:t,name:n.translate("MONTH_"+t)});return e}function T(){var t,a,n,r=[];switch(e.timeMode){case"future":t=E,n=E+100;break;case"past":t=E-100,n=E;break;case"now":t=E-50,n=E+100;break;default:t=E-50,n=E+50}if("future"===e.timeMode)for(a=t;a<=n;a++)r.push(a);else for(a=n;a>=t;a--)r.push(a);return r}function M(){var t=s(e.month,e.year);switch(e.pipDateRangeType){case"monthly":e.day=1;break;case"yearly":e.month=1,e.day=1;break;default:e.days.length!==t.length&&e.day>t.length&&(e.day=t.length)}e.days=t}function f(){var t;t=c(e.month,e.year),e.week=m(e.week,e.month-1,e.year),e.weeks=t}function h(t){var a,n,r,i,o;a=t?new Date(t):null,n=a?a.getUTCDate():null,r=a?a.getUTCMonth()+1:null,i=a?a.getUTCFullYear():null,o=a?m(n,r-1,i):null,e.day===n&&e.month===r&&e.year===i&&e.week===o||(e.day=n,e.month=r,e.year=i,e.week=o,e.days=s(e.month,e.year),e.weeks=c(e.month,e.year))}function y(){var a;"weekly"===e.pipDateRangeType?(a=new Date(e.year,e.month-1,e.week,0,0,0,0),a=new Date(a.getTime()-6e4*a.getTimezoneOffset()),e.model=a):(a=new Date(e.year,e.month-1,e.day,0,0,0,0),a=new Date(a.getTime()-6e4*a.getTimezoneOffset()),e.model=a),w=t.cloneDeep(N),o(),e.onChange()}var _,E,S,O,w={},N={};_=new Date,E=_.getUTCFullYear(),S=_.getUTCMonth()+1,O=_.getUTCDate(),e.daysWeek={en:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ru:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"]},e.onDayChanged=function(){y()},e.onMonthChanged=function(){if("weekly"===e.pipDateRangeType){var t,a;t=new Date(Date.UTC(e.year,e.month-1,1)),a=t.getUTCDay()?t.getUTCDay():7,e.week=m(a,e.month-1,e.year),d(),f()}else M();y()},e.onYearChanged=function(){var t,a;t=new Date(Date.UTC(e.year,e.month-1,1)),a=t.getUTCDay()?t.getUTCDay():7,"weekly"===e.pipDateRangeType?(e.week=m(a,e.month-1,e.year),f(),d()):M(),y()},e.onWeekChange=function(){"weekly"===e.pipDateRangeType?(f(),d()):M(),y()},e.isDay=function(){return"daily"===e.pipDateRangeType},e.isWeek=function(){return"weekly"===e.pipDateRangeType},e.isMonth=function(){return"daily"===e.pipDateRangeType||"weekly"===e.pipDateRangeType||"monthly"===e.pipDateRangeType},e.onChange=function(){e.pipChanged&&e.pipChanged()},e.$mdMedia=r,u(),e.disableControls=!!e.disabled&&e.disabled(),e.$watch("model",function(e,t){e!==t&&h(e)}),e.$watch(e.disabled,function(t){e.disableControls=t}),e.$watch("pipDateRangeType",function(e,t){e!==t&&t&&u()}),e.onYearClick=function(){e.year||(e.year=E)},e.onMonthClick=function(){e.month||(e.month=S)},e.onDayClick=function(){e.year||(e.day=O)}}])}(window.angular,window._),function(){"use strict";var e=angular.module("pipDateTimeFilters",["pipDateFormat"]);e.filter("formatDate",["pipDateFormat",function(e){return function(t,a){return e.formatDate(t,a)}}]),e.filter("formatLongDate",["pipDateFormat",function(e){return function(t){return e.formatLongDate(t)}}]),e.filter("formatLongDateWithYear",["pipDateFormat",function(e){return function(t){return e.formatLongDateWithYear(t)}}]),e.filter("formatMonth",["pipDateFormat",function(e){return function(t,a){return e.formatMonth(t,a)}}]),e.filter("formatShortDate",["pipDateFormat",function(e){return function(t){return e.formatShortDate(t)}}]),e.filter("formatShortDateWithYear",["pipDateFormat",function(e){return function(t){return e.formatShortDateWithYear(t)}}]),e.filter("formatLongMonth",["pipDateFormat",function(e){return function(t){return e.formatLongMonth(t)}}]),e.filter("formatYear",["pipDateFormat",function(e){return function(t){return e.formatYear(t)}}]),e.filter("formatShortWeek",["pipDateFormat",function(e){return function(t){return e.formatShortWeek(t)}}]),e.filter("formatTime",["pipDateFormat",function(e){return function(t,a){return e.formatTime(t,a)}}]),e.filter("formatLongTime",["pipDateFormat",function(e){return function(t){return e.formatLongTime(t)}}]),e.filter("formatShortTime",["pipDateFormat",function(e){return function(t){return e.formatShortTime(t)}}]),e.filter("formatLongDateTime",["pipDateFormat",function(e){return function(t){return e.formatLongDateTime(t)}}]),e.filter("formatShortDateTime",["pipDateFormat",function(e){return function(t){return e.formatShortDateTime(t)}}]),e.filter("formatElapsedInterval",["pipDateFormat",function(e){return function(t){return e.formatElapsedInterval(t)}}]),e.filter("formatElapsedTime",["pipDateFormat",function(e){return function(t){return e.formatElapsedTime(t)}}]),e.filter("formatMillisecondsToSeconds",["pipDateFormat",function(e){return function(t){return e.formatMillisecondsToSeconds(t)}}]),e.filter("formatDateRange",["pipDateFormat",function(e){return function(t,a){return e.formatDateRange(t,a)}}]),e.filter("formatDateTimeRange",["pipDateFormat",function(e){return function(t,a){return e.formatDateTimeRange(t,a)}}])}(),function(){"use strict";var e=angular.module("pipDateFormat",["pipUtils","pipTranslate"]);e.config(["pipTranslateProvider",function(e){e.translations("en",{MONTH_1:"January",MONTH_2:"February",MONTH_3:"March",MONTH_4:"April",MONTH_5:"May",MONTH_6:"June",MONTH_7:"July",MONTH_8:"August",MONTH_9:"September",MONTH_10:"October",MONTH_11:"November",MONTH_12:"December",MONTH_LONG_1:"January",MONTH_LONG_2:"February",MONTH_LONG_3:"March",MONTH_LONG_4:"April",MONTH_LONG_5:"May",MONTH_LONG_6:"June",MONTH_LONG_7:"July",MONTH_LONG_8:"August",MONTH_LONG_9:"September",MONTH_LONG_10:"October",MONTH_LONG_11:"November",MONTH_LONG_12:"December",MONTH_SHORT_1:"Jan",MONTH_SHORT_2:"Feb",MONTH_SHORT_3:"Mar",MONTH_SHORT_4:"Apr",MONTH_SHORT_5:"May",MONTH_SHORT_6:"Jun",MONTH_SHORT_7:"Jul",MONTH_SHORT_8:"Aug",MONTH_SHORT_9:"Sep",MONTH_SHORT_10:"Oct",MONTH_SHORT_11:"Nov",MONTH_SHORT_12:"Dec",DAY_1:"Monday",DAY_2:"Tuesday",DAY_3:"Wednesday",DAY_4:"Thursday",DAY_5:"Friday",DAY_6:"Saturday",DAY_7:"Sunday",ELAPSED_TODAY:"Today",ELAPSED_YESTERDAY:"Yesterday",ELAPSED_YEARS:"y",ELAPSED_MONTHS:"mth",ELAPSED_WEEKS:"w",ELAPSED_DAYS:"d",ELAPSED_HOURS:"h",ELAPSED_MINUTES:"m",ELAPSED_SECONDS:"s",ELAPSED_AT:"at",ELAPSED_AGO:"ago",ELAPSED_JUST_NOW:"Just now",ELAPSED_FEW_MIN_AGO:"Few min ago",ELAPSED_MIN_AGO:"min ago",ELAPSED_HOUR_AGO:"hour ago",ELAPSED_HOURS_AGO:"hours ago",ELAPSED_HOURS_AGO_MORE_THAN_FIVE:"hours ago"}),e.translations("ru",{MONTH_1:"январь",MONTH_2:"февраль",MONTH_3:"март",MONTH_4:"апрель",MONTH_5:"май",MONTH_6:"июнь",MONTH_7:"июль",MONTH_8:"август",MONTH_9:"сентябрь",MONTH_10:"октябрь",MONTH_11:"ноябрь",MONTH_12:"декабрь",MONTH_LONG_1:"января",MONTH_LONG_2:"февраля",MONTH_LONG_3:"марта",MONTH_LONG_4:"апреля",MONTH_LONG_5:"мая",MONTH_LONG_6:"июня",MONTH_LONG_7:"июля",MONTH_LONG_8:"августа",MONTH_LONG_9:"сентября",MONTH_LONG_10:"октября",MONTH_LONG_11:"ноября",MONTH_LONG_12:"декабря",MONTH_SHORT_1:"янв",MONTH_SHORT_2:"фев",MONTH_SHORT_3:"мар",MONTH_SHORT_4:"апр",MONTH_SHORT_5:"май",MONTH_SHORT_6:"июн",MONTH_SHORT_7:"июл",MONTH_SHORT_8:"авг",MONTH_SHORT_9:"сен",MONTH_SHORT_10:"окт",MONTH_SHORT_11:"ноя",MONTH_SHORT_12:"дек",DAY_1:"понедельник",DAY_2:"вторник",DAY_3:"среда",DAY_4:"четверг",DAY_5:"пятница",DAY_6:"суббота",DAY_7:"воскресенье",ELAPSED_TODAY:"Сегодня",ELAPSED_YESTERDAY:"Вчера",ELAPSED_YEARS:"г",ELAPSED_MONTHS:"мц",ELAPSED_WEEKS:"н",ELAPSED_DAYS:"д",ELAPSED_HOURS:"ч",ELAPSED_MINUTES:"м",ELAPSED_SECONDS:"с",ELAPSED_AT:"в",ELAPSED_AGO:"тн",ELAPSED_JUST_NOW:"Только что",ELAPSED_FEW_MIN_AGO:"Несколько мин тн",ELAPSED_MIN_AGO:"мин тн",ELAPSED_HOUR_AGO:"час тн",ELAPSED_HOURS_AGO:"часа тн",ELAPSED_HOURS_AGO_MORE_THAN_FIVE:"часов тн"})}]),e.factory("pipDateFormat",["pipDates","pipTranslate","$rootScope",function(e,t,a){function n(e){return e<10?"0"+e:e}function r(n,r,i){if(null==n)return"";var o=i||!1,n=_.isDate(n)?n:new Date(n),l=(new Date).getUTCFullYear(),d=n.getUTCFullYear(),u=n.getUTCMonth(),p=t.translate("MONTH_LONG_"+(u+1)),s=t.translate("MONTH_SHORT_"+(u+1)),m=t.translate("MONTH_"+(u+1)),D=n.getUTCDate(),c=e.toStartWeek(n),g=e.toEndWeek(n,-1);return 0==o&&"d MMMM yyyy"==r&&l===d&&(r="MMMM d"),0==o&&"d MMM yyyy"==r&&l===d&&(r="MMM d"),"MMM d"==r&&"ru"==a.$language&&(r="d MMM"),"MMMM d"==r&&"ru"==a.$language&&(r="d MMMM"),"d MMMM yyyy"==r?""+D+" "+p+" "+d:"MMMM d, yyyy"==r?""+m+" "+D+", "+d:"d MMM yyyy"==r?""+D+" "+s+" "+d:"MMM d, yyyy"==r?""+s+" "+D+", "+d:"d MMMM"==r?""+D+" "+p:"d MMM"==r?""+D+" "+s:"MMM d"==r?""+s+" "+D:"MMMM d"==r?""+p+" "+D:"yyyy/M/d"==r?""+d+"/"+u+"/"+D:"yyy-M-d"==r?""+d+"-"+u+"-"+D:"MMMM"==r?""+p+" "+d:"yyyy"==r?""+d:"ww"==r?""+c.getUTCDate()+" - "+g.getUTCDate()+" "+m+" "+d:""+D+" "+m+" "+d}function i(e){return r(e,"d MMMM yyyy")}function o(e){return r(e,"d MMM yyyy",!0)}function l(e){return r(e,"d MMMM yyyy",!0)}function d(e){return r(e,"d MMM yyyy")}function u(e){return r(e,"MMMM")}function p(e){return r(e,"yyyy")}function s(e){return r(e,"ww")}function m(e){return r(e,"d MMM")}function D(e){return"ru"==a.$language?r(e,"d MMMM"):r(e,"MMMM d")}function c(e,t){return e=e?_.isDate(e)?e:new Date(e):null,t=t?_.isDate(t)?t:new Date(t):null,null==e?"ru"==a.$language?r(t,"d MMM yyyy",!0):r(t,"MMM d, yyyy",!0):null==t||e==t?"ru"==a.$language?r(e,"d MMM yyyy",!0):r(e,"MMM d, yyyy",!0):e.getUTCFullYear()!==t.getUTCFullYear()?"ru"==a.$language?r(e,"d MMM yyyy",!0)+"-"+r(t,"d MMM yyyy",!0):r(e,"MMM d, yyyy",!0)+"-"+r(t,"MMM d, yyyy",!0):r(e,"d MMM")+" - "+r(t,"d MMM")+((new Date).getUTCFullYear()!==e.getUTCFullYear()?" "+r(e,"yyyy"):"")}function g(e,t){if(e=e?_.isDate(e)?e:new Date(e):null,t=t?_.isDate(t)?t:new Date(t):null,null==e&&null==t)return"";if(null==e)return E(t);if(null==t||e==t)return E(e);var a,n,i,o,l,d;return a=e.getUTCDate(),n=e.getUTCMonth(),i=e.getUTCFullYear(),o=t.getUTCDate(),l=t.getUTCMonth(),d=t.getUTCFullYear(),i!==d?r(e,"d MMM")+", "+i+" "+T(e,"hh:mm")+" - "+r(t,"d MMM")+", "+d+" "+T(t,"hh:mm"):n!=l&&!a!=o?r(e,"d MMM")+", "+T(e,"hh:mm")+" - "+r(t,"d MMM")+", "+T(t,"hh:mm"):T(e,"hh:mm")+" - "+T(t,"hh:mm")}function T(e,a){if(null==e)return"";e=_.isDate(e)?e:new Date(e);var r=e.getHours(),i=e.getMinutes(),o=e.getSeconds(),l="";return"en"==t.use()&&(l=r>=12?" PM":" AM",r%=12,0==r&&(r=12)),"hh:mm:ss"==a?""+n(r)+":"+n(i)+":"+n(o)+l:"hh:mm"==a?""+n(r)+":"+n(i)+l:""+n(r)+":"+n(i)+":"+n(o)+l}function M(e,a){return null==e?"":a?t.translate("MONTH_SHORT_"+e):t.translate("MONTH_"+e)}function f(e){return T(e,"hh:mm:ss")}function h(e){return T(e,"hh:mm")}function y(e){return null==e?"":(e=_.isDate(e)?e:new Date(e),i(e)+" "+f(e))}function E(e){return null==e?"":(e=_.isDate(e)?e:new Date(e),d(e)+" "+h(e))}function S(e,a){if(null==e)return"";e=_.isDate(e)?e:new Date(e);var n=new Date,i=Math.floor((n.getTime()+n.getTimezoneOffset()-(e.getTime()+e.getTimezoneOffset()))/1e3);if(i<1)return t.translate("ELAPSED_JUST_NOW");var o,l,d,u,p,s,m;if(m=i%60,i=Math.floor(i/60),s=i%60,i=Math.floor(i/60),p=i%24,i/=24,o=Math.floor(i/365),i-=365*o,l=Math.floor(i/30),u=Math.floor(i-30*l),u%7==0?(d=Math.floor(u/7),u=0):d=0,"interval"==a){var D="";return o&&(D+=" "+o+t.translate("ELAPSED_YEARS"),d=u=p=s=m=null),l&&(D+=" "+l+t.translate("ELAPSED_MONTHS"),u=p=s=m=null),d&&(D+=" "+d+t.translate("ELAPSED_WEEKS"),p=s=m=null),u&&(D+=" "+u+t.translate("ELAPSED_DAYS"),s=m=null),p&&(D+=" "+p+t.translate("ELAPSED_HOURS"),m=null),s&&(D+=" "+s+t.translate("ELAPSED_MINUTES")),m&&(D+=" "+m+t.translate("ELAPSED_SECONDS")),""!=D?D+" "+t.translate("ELAPSED_AGO"):t.translate("ELAPSED_JUST_NOW")}return o>0?r(e,"d MMM yyyy"):l>0||d>0||u>1?r(e,"MMM d")+", "+T(e,"hh:mm"):1==u?t.translate("ELAPSED_YESTERDAY")+", "+T(e,"hh:mm"):p>10?t.translate("ELAPSED_TODAY")+", "+T(e,"hh:mm"):p>0?""+p+" "+(p<2?t.translate("ELAPSED_HOUR_AGO"):p<5?t.translate("ELAPSED_HOURS_AGO"):t.translate("ELAPSED_HOURS_AGO_MORE_THAN_FIVE")):s>10?""+s+" "+t.translate("ELAPSED_MIN_AGO"):s>0?t.translate("ELAPSED_FEW_MIN_AGO"):t.translate("ELAPSED_JUST_NOW")}function O(e){return S(e,"interval")}function w(e){return Math.floor(e/1e3)}return{formatDate:r,formatLongDate:i,formatShortDate:d,formatShortDateWithYear:o,formatLongDateWithYear:l,formatLongMonth:u,formatMonth:M,formatYear:p,formatShortWeek:s,formatShortDayAndMonth:m,formatLongDayAndMonth:D,formatDateRange:c,formatDateTimeRange:g,formatTime:T,formatLongTime:f,formatShortTime:h,formatLongDateTime:y,formatShortDateTime:E,formatElapsedTime:S,formatElapsedInterval:O,formatMillisecondsToSeconds:w}}])}(),function(e,t){"use strict";var a=e.module("pipTimeRange",["pipUtils"]);a.directive("pipTimeRange",["pipUtils",function(e){return{restrict:"EA",scope:{pipStartDate:"=",pipEndDate:"="},templateUrl:"time_range/time_range.html",link:function(a,n,r){function i(e){return e?new Date(e):null}function o(){null!==a.pipStartDate&&void 0!==a.pipStartDate&&(a.data.start=t.isDate(a.pipStartDate)?a.pipStartDate:i(a.pipStartDate))}function l(){null!==a.pipEndDate&&void 0!==a.pipEndDate&&(a.data.end=t.isDate(a.pipEndDate)?a.pipEndDate:i(a.pipEndDate))}a.data={},a.data.start=null,a.data.end=null,o(),l(),e.toBoolean(r.pipRebind)&&(a.$watch("pipStartDate",function(){a.data.start=null,o()}),a.$watch("pipEndDate",function(){a.data.end=null,l()})),n.addClass("pip-time-range")}}}])}(window.angular,window._),function(e,t){"use strict";var a=e.module("pipTimeRangeEdit",["pipUtils","pipTranslate"]);a.directive("pipTimeRangeEdit",function(){return{restrict:"EA",scope:{pipStartDate:"=",pipChanged:"&",pipEndDate:"=",pipStartLabel:"@",pipEndLabel:"@",disabled:"&ngDisabled",pipSize:"="},templateUrl:"time_range_edit/time_range_edit.html",controller:"pipTimeRangeEditController"}}),a.controller("pipTimeRangeEditController",["$scope","$element","$attrs","pipDates","pipTranslate",function(e,a,n,r,i){function o(e){return e?new Date(e):null}function l(){var t,a;return e.data.startDate&&e.data.endDate?(t=new Date(e.data.startDate.getTime()+60*e.data.startTime*1e3),a=new Date(e.data.endDate.getTime()+60*e.data.endTime*1e3),a-t):null}function d(){var t,a,n;return e.data.startDate?(e.data.startTime||(e.data.endTime?e.data.startTime=0===e.data.endTime?0:e.data.endTime-30:(t=new Date,t=t.getTime()-r.toStartDay(t),e.data.startTime=30*Math.floor(t/18e5))),e.data.endDate?(a=new Date(e.data.startDate.getTime()+60*e.data.startTime*1e3),void(e.data.duration?(n=new Date(a.getTime()+e.data.duration),e.data.endDate=r.toStartDay(n),n=n.getTime()-e.data.endDate.getTime(),e.data.endTime=30*Math.floor(n/18e5)):(n=new Date(e.data.endDate.getTime()+60*e.data.endTime*1e3),a>=n&&(e.data.endDate=r.toStartDay(new Date(a.getTime()+18e5)),e.data.endTime=(e.data.startTime+30)%1440)))):void(e.data.endTime=null)):void(e.data.startTime=null)}function u(){var t,a,n;return e.data.endDate?(e.data.endTime||(e.data.startTime?e.data.endTime=1410===e.data.startTime?1410:e.data.startTime+30:(t=new Date,t=t.getTime()-r.toStartDay(t),e.data.endTime=30*Math.floor(t/18e5))),e.data.startDate?(a=new Date(e.data.startDate.getTime()+60*e.data.startTime*1e3),n=new Date(e.data.endDate.getTime()+60*e.data.endTime*1e3),a>=n&&(e.data.startDate=r.toStartDay(new Date(n.getTime()-18e5)),e.data.startTime=e.data.endTime%1440===0?1410:e.data.endTime-30),void(e.data.duration=l())):void(e.data.startTime=null)):void(e.data.endTime=null)}function p(){var t;e.data.bind=!1,e.data.startDate&&(t=e.data.startTime?60*e.data.startTime*1e3:0,e.pipStartDate=new Date(e.data.startDate.getTime()+t)),e.data.endDate&&(t=e.data.endTime?60*e.data.endTime*1e3:0,e.pipEndDate=new Date(e.data.endDate.getTime()+t)),e.data.bind=!0}function s(){var a,n;null!==e.pipStartDate&&void 0!==e.pipStartDate&&(a=t.isDate(e.pipStartDate)?e.pipStartDate:null,a||(a=o(e.pipStartDate)),e.data.startDate=r.toStartDay(a),e.data.startTime=(new Date(a)-e.data.startDate)/6e4),null!==e.pipEndDate&&void 0!==e.pipEndDate&&(n=t.isDate(e.pipEndDate)?e.pipEndDate:null,a||(n=o(e.pipEndDate)),e.data.endDate=r.toStartDay(n),e.data.endTime=(new Date(n)-e.data.endDate)/6e4),d(),e.data.duration=l(),p()}function m(){var e,a,n,r;for(e=[],a=0;a<24;a++)for(n=0;n<2;n++)r=30*n,e.push({id:60*a+r,time:t.pad(a.toString(),3,"0").substr(0,2)+":"+t.pad(r.toString(),2,"0")});return e}function D(){e.data.startDate=null,e.data.startTime=null,e.data.endDate=null,e.data.endTime=null,e.data.duration=null}e.intervalTimeCollection=m(),e.data={},e.startLabel=e.pipStartLabel?i.translate(e.pipStartLabel):i.translate("EVENT_NEW_START_TIME"),e.endLabel=e.pipEndLabel?i.translate(e.pipEndLabel):i.translate("EVENT_NEW_END_TIME"),D(),s(),e.onChangeStartDate=function(){d(),e.data.duration=l(),p(),e.pipChanged()},e.onChangeEndDate=function(){u(),e.data.duration=l(),p(),e.pipChanged()},e.onChangeStartTime=function(){e.data.startDate||(e.data.startDate=r.toStartDay(new Date)),d(),e.data.duration=l(),p(),e.pipChanged()},e.onChangeEndTime=function(){e.data.endDate||(e.data.endDate=r.toStartDay(new Date)),u(),e.data.duration=l(),p(),e.pipChanged()},e.isDisabled=function(){return!!e.disabled&&e.disabled()},e.$watchGroup([e.pipStartDate,e.pipEndDate],function(){e.data.bind&&(D(),s())}),e.$watch(e.disabled,function(t){e.disableControls=t}),a.addClass("pip-time-range-edit")}])}(window.angular,window._),function(){"use strict";var e=angular.module("pipDatesUtils",[]);e.factory("pipDates",function(){var e={};return e.addHours=function(e,t){e=_.isDate(e)?e:new Date(e);var a=e.getTime()+36e5*t;return new Date(a)},e.toStartDay=function(e){return e=_.isDate(e)?e:new Date(e),new Date(e.getFullYear(),e.getMonth(),e.getDate())},e.toEndDay=function(e,t){e=_.isDate(e)?e:new Date(e),t=null!=t?t:0;var a=new Date(e.getFullYear(),e.getMonth(),e.getDate());return new Date(a.getTime()+864e5+t)},e.toStartWeek=function(e){e=_.isDate(e)?e:new Date(e);var t=e.getDay()?e.getDay():7;return e=new Date(e.getFullYear(),e.getMonth(),e.getDate()),new Date(e.getTime()-24*(t-1)*36e5)},e.toEndWeek=function(e,t){e=_.isDate(e)?e:new Date(e),t=null!=t?t:0;var a=e.getDay()?e.getDay():7;return e=new Date(e.getFullYear(),e.getMonth(),e.getDate()),new Date(e.getTime()+24*(8-a)*36e5+t)},e.toStartMonth=function(e){return e=_.isDate(e)?e:new Date(e),new Date(e.getFullYear(),e.getMonth(),1)},e.toEndMonth=function(e,t){e=_.isDate(e)?e:new Date(e);var a=e.getMonth()+1,n=e.getFullYear();return a>11&&(n++,a=0),e=new Date(n,a,1),null!=t&&(e=new Date(e.getTime()+t)),e},e.toStartYear=function(e){return e=_.isDate(e)?e:new Date(e),new Date(e.getFullYear(),0,1)},e.toEndYear=function(e,t){return e=_.isDate(e)?e:new Date(e),e=new Date(e.getFullYear()+1,0,1),null!=t&&(e=new Date(e.getTime()+t)),e},e.toUTCDate=function(e,t,a){return new Date(Date.UTC(e,t,a))},e.toUTCDate=function(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))},e.fromUTCDate=function(e){return null==e&&(e=new Date),new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())},e.toUTCStartWeek=function(e){_.isDate(e)||(e=new Date(e),e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())));var t=e.getDay()?e.getDay():7;return e=new Date(e.getFullYear(),e.getMonth(),e.getDate()),e=1!=t?new Date(e.getTime()-24*(t-1)*36e5):e,new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))},e.toUTCEndWeek=function(e,t){_.isDate(e)||(e=new Date(e),e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))),t=null!=t?t:0;var a=e.getDay()?e.getDay():7;return e=new Date(e.getFullYear(),e.getMonth(),e.getDate()),e=new Date(e.getTime()+24*(8-a)*36e5+t),new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))},e})}();