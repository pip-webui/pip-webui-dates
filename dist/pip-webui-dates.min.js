!function(e){try{e=angular.module("pipDates.Templates")}catch(t){e=angular.module("pipDates.Templates",[])}e.run(["$templateCache",function(e){e.put("date/date.html",'<div class="pip-date layout-row flex" tabindex="-1"><md-input-container class="tm0 flex"><md-select class="pip-date-day tm0 flex" ng-disabled="disableControls" ng-model="day" placeholder="{{dayLabel}}" ng-change="onDayChanged()"><md-option ng-value="opt" ng-repeat="opt in days track by opt">{{:: opt }}</md-option></md-select></md-input-container><div class="w16 flex-fixed"></div><md-input-container class="tm0 flex"><md-select class="pip-date-month tm0 flex" ng-disabled="disableControls" ng-model="month" placeholder="{{monthLabel}}" ng-change="onMonthChanged()"><md-option ng-value="opt.id" ng-repeat="opt in months track by opt.id">{{:: opt.name }}</md-option></md-select></md-input-container><div class="w16 flex-fixed"></div><md-input-container class="tm0 flex"><md-select class="pip-date-year tm0 flex" ng-disabled="disableControls" ng-model="year" placeholder="{{yearLabel}}" ng-change="onYearChanged()"><md-option ng-value="opt" ng-repeat="opt in years track by opt">{{:: opt }}</md-option></md-select></md-input-container></div>')}])}(),function(e){try{e=angular.module("pipDates.Templates")}catch(t){e=angular.module("pipDates.Templates",[])}e.run(["$templateCache",function(e){e.put("date_range/date_range.html",'<div class="pip-date-range layout-row flex" tabindex="-1"><md-input-container ng-show="isDay()" class="tm0 pip-day flex" ng-class="{\'flex-fixed\' : $mdMedia(\'gt-xs\')}"><md-select class="select-day w-stretch" ng-class="{\'pip-no-line\' : pipNoLine}" ng-disable="{{disableControls}}" md-on-open="onDayClick()" ng-model="day" ng-change="onDayChanged()" placeholder="{{dayLabel}}" aria-label="DAY"><md-option ng-value="opt" ng-repeat="opt in days track by opt">{{nameDays[$index]}} {{ opt }}</md-option></md-select></md-input-container><md-input-container ng-show="isWeek()" class="tm0 flex" ng-class="{\'flex-fixed\' : $mdMedia(\'gt-xs\')}"><md-select class="select-week w-stretch" ng-class="{\'pip-no-line\' : pipNoLine}" ng-disable="{{disableControls}}" ng-model="week" ng-change="onWeekChange()" placeholder="{{weekLabel}}" aria-label="WEEK"><md-option ng-value="opt.id" ng-repeat="opt in weeks track by opt.id">{{ opt.name }}</md-option></md-select></md-input-container><div class="flex-fixed" ng-class="{\'w16\': $mdMedia(\'gt-xs\'), \'w8\': $mdMedia(\'xs\')}" ng-show="isDay() || isWeek()"></div><md-input-container ng-show="isMonth() && !monthFormatShort" class="tm0 flex min-w72" ng-class="{\'flex-fixed\' : $mdMedia(\'gt-xs\')}"><md-select class="select-month w-stretch" ng-class="{\'pip-no-line\' : pipNoLine}" ng-disable="{{disableControls}}" md-on-open="onMonthClick()" ng-model="month" ng-change="onMonthChanged()" placeholder="{{monthLabel}}" aria-label="MONTH"><md-option ng-value="opt.id" ng-repeat="opt in months track by opt.id">{{ opt.name }}</md-option></md-select></md-input-container><md-input-container ng-show="isMonth() && monthFormatShort" class="flex tm0" ng-class="{\'flex-fixed\' : $mdMedia(\'gt-xs\')}"><md-select class="select-month w-stretch" ng-class="{\'pip-no-line\' : pipNoLine}" ng-disable="{{disableControls}}" md-on-open="onMonthClick()" ng-model="month" ng-change="onMonthChanged()" placeholder="{{monthLabel}}" aria-label="MONTH"><md-option ng-value="opt.id" ng-repeat="opt in shortMonths track by opt.id">{{ opt.name }}</md-option></md-select></md-input-container><div class="flex-fixed" ng-class="{\'w16\': $mdMedia(\'gt-xs\'), \'w8\': $mdMedia(\'xs\')}" ng-show="isMonth()"></div><md-input-container class="tm0 flex" ng-class="{\'flex-fixed\' : $mdMedia(\'gt-xs\')}"><md-select class="select-year w-stretch" ng-class="{\'pip-no-line\' : pipNoLine}" ng-disable="{{disableControls}}" md-on-open="onYearClick()" ng-model="year" ng-change="onYearChanged()" placeholder="{{yearLabel}}" aria-label="YEAR"><md-option ng-value="opt" ng-repeat="opt in years track by opt">{{ opt }}</md-option></md-select></md-input-container></div>')}])}(),function(e){try{e=angular.module("pipDates.Templates")}catch(t){e=angular.module("pipDates.Templates",[])}e.run(["$templateCache",function(e){e.put("time_range/time_range.html",'<p><span ng-if="data.start != null">{{data.start | formatShortDateTime}}</span> <span class="rm4 lm4" ng-if="data.start && data.end">-</span> <span ng-if="data.end != null">{{data.end | formatShortDateTime}}</span></p>')}])}(),function(e){try{e=angular.module("pipDates.Templates")}catch(t){e=angular.module("pipDates.Templates",[])}e.run(["$templateCache",function(e){e.put("time_range_edit/time_range_edit.html",'<div class="event-edit layout-row layout-xs-column flex layout-align-start-start"><div flex="47" class="w-stretch rm24-flex0"><p class="text-caption text-grey tm0">{{startLabel}}</p><div class="layout-row layout-align-space-between-center"><div class="rm16 pip-datepicker-container" flex="49"><md-datepicker ng-model="data.startDate" xmd-placeholder="{{startLabel}}" ng-change="onChangeStartDate()" ng-disabled="isDisabled()" aria-label="START-DATE"></md-datepicker></div><div flex=""><md-input-container class="w-stretch tm0"><md-select aria-label="START-TIME" class="tm0 bm0" ng-model="data.startTime" ng-disabled="isDisabled()" ng-change="onChangeStartTime()"><md-option ng-value="opt.id" ng-repeat="opt in intervalTimeCollection track by opt.id">{{ opt.time }}</md-option></md-select></md-input-container></div></div></div><div flex="47" class="w-stretch"><p class="text-caption text-grey tm0">{{endLabel}}</p><div class="layout-row layout-align-space-between-center"><div class="rm16 pip-datepicker-container flex-49"><md-datepicker ng-model="data.endDate" xmd-placeholder="{{endLabel}}" ng-disabled="isDisabled()" ng-change="onChangeEndDate()" aria-label="END-DATE"></md-datepicker></div><div flex=""><md-input-container class="w-stretch tm0"><md-select aria-label="END-TIME" class="tm0 bm0" ng-model="data.endTime" ng-change="onChangeEndTime()" ng-disabled="isDisabled()"><md-option ng-value="opt.id" ng-repeat="opt in intervalTimeCollection track by opt.id">{{ opt.time }}</md-option></md-select></md-input-container></div></div></div></div>')}])}(),function(e){"use strict";e.module("pipDateTimes",["pipDate","pipDateRange","pipTimeRangeEdit","pipTimeRange","pipDatesUtils","pipDateFormat","pipDateTimeFilters"])}(window.angular),function(e,t){"use strict";var a=e.module("pipDate",["pipDates.Templates"]);a.directive("pipDate",function(){return{restrict:"EA",require:"ngModel",scope:{timeMode:"@pipTimeMode",disabled:"&ngDisabled",model:"=ngModel",ngChange:"&"},templateUrl:"date/date.html",controller:"pipDateController"}}),a.controller("pipDateController",["$scope","$element",function(e,a){function n(e,t){var a,n=31,i=[];for(4===e||6===e||9===e||11===e?n=30:2===e&&(n=t&&t%4===0?29:28),a=1;a<=n;a++)i.push(a);return i}function i(){var e,t=[];for(e=1;e<=12;e++)t.push({id:e,name:""});return t}function r(){var t,a=(new Date).getFullYear(),n="future"===e.timeMode?a:a-100,i="past"===e.timeMode?a:a+100,r=[];if("past"===e.timeMode)for(t=i;t>=n;t--)r.push(t);else for(t=n;t<=i;t++)r.push(t);return r}function o(){var t=n(e.month,e.year);e.days.length!==t.length&&(e.day>t.length&&(e.day=t.length),e.days=t)}function l(a){var i=a?t.isDate(a)?a:new Date(a):null,r=i?i.getDate():null,o=i?i.getMonth()+1:null,l=i?i.getFullYear():null;e.month!==o&&e.year!==l&&(e.days=n(e.month,e.year)),e.day=r,e.month=o,e.year=l}function d(){var t;e.day&&e.month&&e.year&&(t=new Date(e.year,e.month-1,e.day,0,0,0,0),e.model=t,e.ngChange())}var u;e.onDayChanged=function(){d()},e.onMonthChanged=function(){o(),d()},e.onYearChanged=function(){o(),d()},u=e.model?t.isDate(e.model)?e.model:new Date(e.model):null,e.day=u?u.getDate():null,e.month=u?u.getMonth()+1:null,e.year=u?u.getFullYear():null,e.dayLabel="day",e.monthLabel="month",e.yearLabel="year",e.days=n(e.month,e.year),e.months=i(),e.years=r(),e.disableControls=!!e.disabled&&e.disabled(),e.$watch("model",function(e){l(e)}),e.$watch(e.disabled,function(t){e.disableControls=t})}])}(window.angular,window._),function(e,t){"use strict";var a=e.module("pipDateRange",["pipDates.Templates"]);a.directive("pipDateRange",function(){return{restrict:"EA",require:"ngModel",scope:{timeMode:"@pipTimeMode",disabled:"&ngDisabled",model:"=ngModel",pipChanged:"&",pipDateRangeType:"@",pipDateFormat:"@",pipNoLine:"@"},templateUrl:"date_range/date_range.html",controller:"pipDateRangeController"}}),a.controller("pipDateRangeController",["$scope","$element","$mdMedia","$rootScope",function(e,a,n,i){function r(){S.day=e.day,S.month=e.month,S.year=e.year,S.week=e.week,S.dateRangeType=e.pipDateRangeType,S.model=e.model}function o(){e.days=m(e.month,e.year),e.weeks=c(e.month,e.year),e.months=g(),e.shortMonths=g(!0),e.years=D()}function l(){(!b.model||b.model&&b.model.getTime()>=e.model.getTime())&&e.weeks&&e.weeks[e.week]&&e.weeks[e.week].id<=0&&(e.month<12?e.month+=1:(e.month=1,e.year+=1),o())}function d(){var t;t=e.model?new Date(e.model):null,e.day=t?t.getUTCDate():null,e.month=t?t.getUTCMonth()+1:null,e.year=t?t.getUTCFullYear():null,e.week=t?p(e.day,e.month-1,e.year):null,o(),"weekly"===e.pipDateRangeType?(l(),h()):f(),M()}function u(e,t){var a=31;return 4===e||6===e||9===e||11===e?a=30:2===e&&(a=t&&t%4===0?29:28),a}function m(t,a){var n,r,o,l;for(l=i.$language||"en",n=u(t,a),e.nameDays=[],r=[],o=1;o<=n;o++)r.push(o),e.nameDays.push(e.daysWeek[l][new Date(a,t-1,o).getDay()]);return r}function p(e,t,a){var n,i,r;return n=new Date(Date.UTC(a,t,e)),i=n.getUTCDay()?n.getUTCDay():7,r=1===i?e:e+1-i}function s(e,t,a){var n,i;return n=e+6>t?t-e-6:e+6,i=e>0?e:a+e,i.toString()+" - "+Math.abs(n).toString()}function c(e,t){var a,n,i,r;for(a=[],n=u(e,t),r=p(1,e-1,t),i=e-1?u(e-1,t):u(12,t-1);r<n+1;)a.push({id:r,name:s(r,n,i)}),r+=7;return a}function g(){var e,t;for(e=[],t=1;t<=12;t++)e.push({id:t,name:""});return e}function D(){var t,a,n,i=[];switch(e.timeMode){case"future":t=w,n=w+100;break;case"past":t=w-100,n=w;break;case"now":t=w-50,n=w+100;break;default:t=w-50,n=w+50}if("future"===e.timeMode)for(a=t;a<=n;a++)i.push(a);else for(a=n;a>=t;a--)i.push(a);return i}function f(){var t=m(e.month,e.year);switch(e.pipDateRangeType){case"monthly":e.day=1;break;case"yearly":e.month=1,e.day=1;break;default:e.days.length!==t.length&&e.day>t.length&&(e.day=t.length)}e.days=t}function h(){var t;t=c(e.month,e.year),e.week=p(e.week,e.month-1,e.year),e.weeks=t}function y(t){var a,n,i,r,o;a=t?new Date(t):null,n=a?a.getUTCDate():null,i=a?a.getUTCMonth()+1:null,r=a?a.getUTCFullYear():null,o=a?p(n,i-1,r):null,e.day===n&&e.month===i&&e.year===r&&e.week===o||(e.day=n,e.month=i,e.year=r,e.week=o,e.days=m(e.month,e.year),e.weeks=c(e.month,e.year))}function M(){var a;"weekly"===e.pipDateRangeType?(a=new Date(e.year,e.month-1,e.week,0,0,0,0),a=new Date(a.getTime()-6e4*a.getTimezoneOffset()),e.model=a):(a=new Date(e.year,e.month-1,e.day,0,0,0,0),a=new Date(a.getTime()-6e4*a.getTimezoneOffset()),e.model=a),b=t.cloneDeep(S),r(),e.onChange()}var T,w,C,v,b={},S={};T=new Date,w=T.getUTCFullYear(),C=T.getUTCMonth()+1,v=T.getUTCDate(),e.daysWeek={en:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ru:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"]},e.onDayChanged=function(){M()},e.onMonthChanged=function(){if("weekly"===e.pipDateRangeType){var t,a;t=new Date(Date.UTC(e.year,e.month-1,1)),a=t.getUTCDay()?t.getUTCDay():7,e.week=p(a,e.month-1,e.year),l(),h()}else f();M()},e.onYearChanged=function(){var t,a;t=new Date(Date.UTC(e.year,e.month-1,1)),a=t.getUTCDay()?t.getUTCDay():7,"weekly"===e.pipDateRangeType?(e.week=p(a,e.month-1,e.year),h(),l()):f(),M()},e.onWeekChange=function(){"weekly"===e.pipDateRangeType?(h(),l()):f(),M()},e.isDay=function(){return"daily"===e.pipDateRangeType},e.isWeek=function(){return"weekly"===e.pipDateRangeType},e.isMonth=function(){return"daily"===e.pipDateRangeType||"weekly"===e.pipDateRangeType||"monthly"===e.pipDateRangeType},e.onChange=function(){e.pipChanged&&e.pipChanged()},e.$mdMedia=n,d(),e.disableControls=!!e.disabled&&e.disabled(),e.$watch("model",function(e,t){e!==t&&y(e)}),e.$watch(e.disabled,function(t){e.disableControls=t}),e.$watch("pipDateRangeType",function(e,t){e!==t&&t&&d()}),e.onYearClick=function(){e.year||(e.year=w)},e.onMonthClick=function(){e.month||(e.month=C)},e.onDayClick=function(){e.year||(e.day=v)}}])}(window.angular,window._),function(){"use strict";var e=angular.module("pipDateTimeFilters",["pipDateFormat"]);e.filter("formatDate",["pipDateFormat",function(e){return function(t,a){return e.formatDate(t,a)}}]),e.filter("formatLongDate",["pipDateFormat",function(e){return function(t){return e.formatLongDate(t)}}]),e.filter("formatLongDateWithYear",["pipDateFormat",function(e){return function(t){return e.formatLongDateWithYear(t)}}]),e.filter("formatMonth",["pipDateFormat",function(e){return function(t,a){return e.formatMonth(t,a)}}]),e.filter("formatShortDate",["pipDateFormat",function(e){return function(t){return e.formatShortDate(t)}}]),e.filter("formatShortDateWithYear",["pipDateFormat",function(e){return function(t){return e.formatShortDateWithYear(t)}}]),e.filter("formatLongMonth",["pipDateFormat",function(e){return function(t){return e.formatLongMonth(t)}}]),e.filter("formatYear",["pipDateFormat",function(e){return function(t){return e.formatYear(t)}}]),e.filter("formatShortWeek",["pipDateFormat",function(e){return function(t){return e.formatShortWeek(t)}}]),e.filter("formatTime",["pipDateFormat",function(e){return function(t,a){return e.formatTime(t,a)}}]),e.filter("formatLongTime",["pipDateFormat",function(e){return function(t){return e.formatLongTime(t)}}]),e.filter("formatShortTime",["pipDateFormat",function(e){return function(t){return e.formatShortTime(t)}}]),e.filter("formatLongDateTime",["pipDateFormat",function(e){return function(t){return e.formatLongDateTime(t)}}]),e.filter("formatShortDateTime",["pipDateFormat",function(e){return function(t){return e.formatShortDateTime(t)}}]),e.filter("formatElapsedInterval",["pipDateFormat",function(e){return function(t){return e.formatElapsedInterval(t)}}]),e.filter("formatElapsedTime",["pipDateFormat",function(e){return function(t){return e.formatElapsedTime(t)}}]),e.filter("formatMillisecondsToSeconds",["pipDateFormat",function(e){return function(t){return e.formatMillisecondsToSeconds(t)}}]),e.filter("formatDateRange",["pipDateFormat",function(e){return function(t,a){return e.formatDateRange(t,a)}}]),e.filter("formatDateTimeRange",["pipDateFormat",function(e){return function(t,a){return e.formatDateTimeRange(t,a)}}])}(),function(){"use strict";var e=angular.module("pipDateFormat",[]);e.config(function(){}),e.factory("pipDateFormat",["pipDates","$rootScope",function(e,t){function a(e){return e<10?"0"+e:e}function n(a,n,i){if(null==a)return"";var r=i||!1,a=_.isDate(a)?a:new Date(a),o=(new Date).getUTCFullYear(),l=a.getUTCFullYear(),d=a.getUTCMonth(),u=a.getUTCDate(),m=e.toStartWeek(a),p=e.toEndWeek(a,-1);return 0==r&&"d MMMM yyyy"==n&&o===l&&(n="MMMM d"),0==r&&"d MMM yyyy"==n&&o===l&&(n="MMM d"),"MMM d"==n&&"ru"==t.$language&&(n="d MMM"),"MMMM d"==n&&"ru"==t.$language&&(n="d MMMM"),"d MMMM yyyy"==n?""+u+" "+longMonthName+" "+l:"MMMM d, yyyy"==n?""+monthName+" "+u+", "+l:"d MMM yyyy"==n?""+u+" "+shortMonthName+" "+l:"MMM d, yyyy"==n?""+shortMonthName+" "+u+", "+l:"d MMMM"==n?""+u+" "+longMonthName:"d MMM"==n?""+u+" "+shortMonthName:"MMM d"==n?""+shortMonthName+" "+u:"MMMM d"==n?""+longMonthName+" "+u:"yyyy/M/d"==n?""+l+"/"+d+"/"+u:"yyy-M-d"==n?""+l+"-"+d+"-"+u:"MMMM"==n?""+longMonthName+" "+l:"yyyy"==n?""+l:"ww"==n?""+m.getUTCDate()+" - "+p.getUTCDate()+" "+monthName+" "+l:""+u+" "+monthName+" "+l}function i(e){return n(e,"d MMMM yyyy")}function r(e){return n(e,"d MMM yyyy",!0)}function o(e){return n(e,"d MMMM yyyy",!0)}function l(e){return n(e,"d MMM yyyy")}function d(e){return n(e,"MMMM")}function u(e){return n(e,"yyyy")}function m(e){return n(e,"ww")}function p(e){return n(e,"d MMM")}function s(e){return"ru"==t.$language?n(e,"d MMMM"):n(e,"MMMM d")}function c(e,a){return e=e?_.isDate(e)?e:new Date(e):null,a=a?_.isDate(a)?a:new Date(a):null,null==e?"ru"==t.$language?n(a,"d MMM yyyy",!0):n(a,"MMM d, yyyy",!0):null==a||e==a?"ru"==t.$language?n(e,"d MMM yyyy",!0):n(e,"MMM d, yyyy",!0):e.getUTCFullYear()!==a.getUTCFullYear()?"ru"==t.$language?n(e,"d MMM yyyy",!0)+"-"+n(a,"d MMM yyyy",!0):n(e,"MMM d, yyyy",!0)+"-"+n(a,"MMM d, yyyy",!0):n(e,"d MMM")+" - "+n(a,"d MMM")+((new Date).getUTCFullYear()!==e.getUTCFullYear()?" "+n(e,"yyyy"):"")}function g(e,t){if(e=e?_.isDate(e)?e:new Date(e):null,t=t?_.isDate(t)?t:new Date(t):null,null==e&&null==t)return"";if(null==e)return T(t);if(null==t||e==t)return T(e);var a,i,r,o,l,d;return a=e.getUTCDate(),i=e.getUTCMonth(),r=e.getUTCFullYear(),o=t.getUTCDate(),l=t.getUTCMonth(),d=t.getUTCFullYear(),r!==d?n(e,"d MMM")+", "+r+" "+D(e,"hh:mm")+" - "+n(t,"d MMM")+", "+d+" "+D(t,"hh:mm"):i!=l&&!a!=o?n(e,"d MMM")+", "+D(e,"hh:mm")+" - "+n(t,"d MMM")+", "+D(t,"hh:mm"):D(e,"hh:mm")+" - "+D(t,"hh:mm")}function D(e,t){if(null==e)return"";e=_.isDate(e)?e:new Date(e);var n=e.getHours(),i=e.getMinutes(),r=e.getSeconds(),o="";return"hh:mm:ss"==t?""+a(n)+":"+a(i)+":"+a(r)+o:"hh:mm"==t?""+a(n)+":"+a(i)+o:""+a(n)+":"+a(i)+":"+a(r)+o}function f(e,t){return null==e?"":"MONTH_SHORT_"+e}function h(e){return D(e,"hh:mm:ss")}function y(e){return D(e,"hh:mm")}function M(e){return null==e?"":(e=_.isDate(e)?e:new Date(e),i(e)+" "+h(e))}function T(e){return null==e?"":(e=_.isDate(e)?e:new Date(e),l(e)+" "+y(e))}function w(e,t){if(null==e)return"";e=_.isDate(e)?e:new Date(e);var a=new Date,n=Math.floor((a.getTime()+a.getTimezoneOffset()-(e.getTime()+e.getTimezoneOffset()))/1e3);if(n<1)return"ELAPSED_JUST_NOW";var i,r,o,l,d,u,m;m=n%60,n=Math.floor(n/60),u=n%60,n=Math.floor(n/60),d=n%24,n/=24,i=Math.floor(n/365),n-=365*i,r=Math.floor(n/30),l=Math.floor(n-30*r),l%7==0?(o=Math.floor(l/7),l=0):o=0}function C(e){return w(e,"interval")}function v(e){return Math.floor(e/1e3)}return{formatDate:n,formatLongDate:i,formatShortDate:l,formatShortDateWithYear:r,formatLongDateWithYear:o,formatLongMonth:d,formatMonth:f,formatYear:u,formatShortWeek:m,formatShortDayAndMonth:p,formatLongDayAndMonth:s,formatDateRange:c,formatDateTimeRange:g,formatTime:D,formatLongTime:h,formatShortTime:y,formatLongDateTime:M,formatShortDateTime:T,formatElapsedTime:w,formatElapsedInterval:C,formatMillisecondsToSeconds:v}}])}(),function(e,t){"use strict";var a=e.module("pipTimeRange",[]);a.directive("pipTimeRange",function(){return{restrict:"EA",scope:{pipStartDate:"=",pipEndDate:"="},templateUrl:"time_range/time_range.html",link:function(e,a,n){function i(e){return e?new Date(e):null}function r(){null!==e.pipStartDate&&void 0!==e.pipStartDate&&(e.data.start=t.isDate(e.pipStartDate)?e.pipStartDate:i(e.pipStartDate))}function o(){null!==e.pipEndDate&&void 0!==e.pipEndDate&&(e.data.end=t.isDate(e.pipEndDate)?e.pipEndDate:i(e.pipEndDate))}function l(e){return null!=e&&(!!e&&(e=e.toString().toLowerCase(),"1"==e||"true"==e))}e.data={},e.data.start=null,e.data.end=null,r(),o(),l(n.pipRebind)&&(e.$watch("pipStartDate",function(){e.data.start=null,r()}),e.$watch("pipEndDate",function(){e.data.end=null,o()})),a.addClass("pip-time-range")}}})}(window.angular,window._),function(e,t){"use strict";var a=e.module("pipTimeRangeEdit",["pipDatesUtils"]);a.directive("pipTimeRangeEdit",function(){return{restrict:"EA",scope:{pipStartDate:"=",pipChanged:"&",pipEndDate:"=",pipStartLabel:"@",pipEndLabel:"@",disabled:"&ngDisabled",pipSize:"="},templateUrl:"time_range_edit/time_range_edit.html",controller:"pipTimeRangeEditController"}}),a.controller("pipTimeRangeEditController",["$scope","$element","$attrs","pipDates","pipTranslate",function(e,a,n,i,r){function o(e){return e?new Date(e):null}function l(){var t,a;return e.data.startDate&&e.data.endDate?(t=new Date(e.data.startDate.getTime()+60*e.data.startTime*1e3),a=new Date(e.data.endDate.getTime()+60*e.data.endTime*1e3),a-t):null}function d(){var t,a,n;return e.data.startDate?(e.data.startTime||(e.data.endTime?e.data.startTime=0===e.data.endTime?0:e.data.endTime-30:(t=new Date,t=t.getTime()-i.toStartDay(t),e.data.startTime=30*Math.floor(t/18e5))),e.data.endDate?(a=new Date(e.data.startDate.getTime()+60*e.data.startTime*1e3),void(e.data.duration?(n=new Date(a.getTime()+e.data.duration),e.data.endDate=i.toStartDay(n),n=n.getTime()-e.data.endDate.getTime(),e.data.endTime=30*Math.floor(n/18e5)):(n=new Date(e.data.endDate.getTime()+60*e.data.endTime*1e3),a>=n&&(e.data.endDate=i.toStartDay(new Date(a.getTime()+18e5)),e.data.endTime=(e.data.startTime+30)%1440)))):void(e.data.endTime=null)):void(e.data.startTime=null)}function u(){var t,a,n;return e.data.endDate?(e.data.endTime||(e.data.startTime?e.data.endTime=1410===e.data.startTime?1410:e.data.startTime+30:(t=new Date,t=t.getTime()-i.toStartDay(t),e.data.endTime=30*Math.floor(t/18e5))),e.data.startDate?(a=new Date(e.data.startDate.getTime()+60*e.data.startTime*1e3),n=new Date(e.data.endDate.getTime()+60*e.data.endTime*1e3),a>=n&&(e.data.startDate=i.toStartDay(new Date(n.getTime()-18e5)),e.data.startTime=e.data.endTime%1440===0?1410:e.data.endTime-30),void(e.data.duration=l())):void(e.data.startTime=null)):void(e.data.endTime=null)}function m(){var t;e.data.bind=!1,e.data.startDate&&(t=e.data.startTime?60*e.data.startTime*1e3:0,e.pipStartDate=new Date(e.data.startDate.getTime()+t)),e.data.endDate&&(t=e.data.endTime?60*e.data.endTime*1e3:0,e.pipEndDate=new Date(e.data.endDate.getTime()+t)),e.data.bind=!0}function p(){var a,n;null!==e.pipStartDate&&void 0!==e.pipStartDate&&(a=t.isDate(e.pipStartDate)?e.pipStartDate:null,a||(a=o(e.pipStartDate)),e.data.startDate=i.toStartDay(a),e.data.startTime=(new Date(a)-e.data.startDate)/6e4),null!==e.pipEndDate&&void 0!==e.pipEndDate&&(n=t.isDate(e.pipEndDate)?e.pipEndDate:null,a||(n=o(e.pipEndDate)),e.data.endDate=i.toStartDay(n),e.data.endTime=(new Date(n)-e.data.endDate)/6e4),d(),e.data.duration=l(),m()}function s(){var e,a,n,i;for(e=[],a=0;a<24;a++)for(n=0;n<2;n++)i=30*n,e.push({id:60*a+i,time:t.pad(a.toString(),3,"0").substr(0,2)+":"+t.pad(i.toString(),2,"0")});return e}function c(){e.data.startDate=null,e.data.startTime=null,e.data.endDate=null,e.data.endTime=null,e.data.duration=null}e.intervalTimeCollection=s(),e.data={},e.startLabel=e.pipStartLabel?r.translate(e.pipStartLabel):r.translate("EVENT_NEW_START_TIME"),e.endLabel=e.pipEndLabel?r.translate(e.pipEndLabel):r.translate("EVENT_NEW_END_TIME"),c(),p(),e.onChangeStartDate=function(){d(),e.data.duration=l(),m(),e.pipChanged()},e.onChangeEndDate=function(){u(),e.data.duration=l(),m(),e.pipChanged()},e.onChangeStartTime=function(){e.data.startDate||(e.data.startDate=i.toStartDay(new Date)),d(),e.data.duration=l(),m(),e.pipChanged()},e.onChangeEndTime=function(){e.data.endDate||(e.data.endDate=i.toStartDay(new Date)),u(),e.data.duration=l(),m(),e.pipChanged()},e.isDisabled=function(){return!!e.disabled&&e.disabled()},e.$watchGroup([e.pipStartDate,e.pipEndDate],function(){e.data.bind&&(c(),p())}),e.$watch(e.disabled,function(t){e.disableControls=t}),a.addClass("pip-time-range-edit")}])}(window.angular,window._),function(){"use strict";var e=angular.module("pipDatesUtils",[]);e.factory("pipDates",function(){var e={};return e.addHours=function(e,t){e=_.isDate(e)?e:new Date(e);var a=e.getTime()+36e5*t;return new Date(a)},e.toStartDay=function(e){return e=_.isDate(e)?e:new Date(e),new Date(e.getFullYear(),e.getMonth(),e.getDate())},e.toEndDay=function(e,t){e=_.isDate(e)?e:new Date(e),t=null!=t?t:0;var a=new Date(e.getFullYear(),e.getMonth(),e.getDate());return new Date(a.getTime()+864e5+t)},e.toStartWeek=function(e){e=_.isDate(e)?e:new Date(e);var t=e.getDay()?e.getDay():7;return e=new Date(e.getFullYear(),e.getMonth(),e.getDate()),new Date(e.getTime()-24*(t-1)*36e5)},e.toEndWeek=function(e,t){e=_.isDate(e)?e:new Date(e),t=null!=t?t:0;var a=e.getDay()?e.getDay():7;return e=new Date(e.getFullYear(),e.getMonth(),e.getDate()),new Date(e.getTime()+24*(8-a)*36e5+t)},e.toStartMonth=function(e){return e=_.isDate(e)?e:new Date(e),new Date(e.getFullYear(),e.getMonth(),1)},e.toEndMonth=function(e,t){e=_.isDate(e)?e:new Date(e);var a=e.getMonth()+1,n=e.getFullYear();return a>11&&(n++,a=0),e=new Date(n,a,1),null!=t&&(e=new Date(e.getTime()+t)),e},e.toStartYear=function(e){return e=_.isDate(e)?e:new Date(e),new Date(e.getFullYear(),0,1)},e.toEndYear=function(e,t){return e=_.isDate(e)?e:new Date(e),e=new Date(e.getFullYear()+1,0,1),null!=t&&(e=new Date(e.getTime()+t)),e},e.toUTCDate=function(e,t,a){return new Date(Date.UTC(e,t,a))},e.toUTCDate=function(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))},e.fromUTCDate=function(e){return null==e&&(e=new Date),new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())},e.toUTCStartWeek=function(e){_.isDate(e)||(e=new Date(e),e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())));var t=e.getDay()?e.getDay():7;return e=new Date(e.getFullYear(),e.getMonth(),e.getDate()),e=1!=t?new Date(e.getTime()-24*(t-1)*36e5):e,new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))},e.toUTCEndWeek=function(e,t){_.isDate(e)||(e=new Date(e),e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))),t=null!=t?t:0;var a=e.getDay()?e.getDay():7;return e=new Date(e.getFullYear(),e.getMonth(),e.getDate()),e=new Date(e.getTime()+24*(8-a)*36e5+t),new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()))},e})}();